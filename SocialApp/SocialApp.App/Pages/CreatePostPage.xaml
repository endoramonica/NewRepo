<ContentPage Title="Táº¡o bÃ i viáº¿t"
             Shell.NavBarIsVisible="False"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:controls="clr-namespace:SocialApp.App.Controls"
             xmlns:vm="clr-namespace:SocialApp.App.ViewModels"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="SocialApp.App.Pages.CreatePostPage"
             Padding="10,15"
             x:DataType="vm:SavePostViewModel">
    <!--Äá»ƒ táº¡o NullOrEmptyToBoolConverter, báº¡n cÃ³ thá»ƒ thÃªm mÃ£ sau trong pháº§n resources cá»§a XAML:-->
    <ContentPage.Resources>
        <ResourceDictionary>
            <controls:NullOrEmptyToBoolConverter x:Key="NullOrEmptyToBoolConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>
    <!-- Page title: "Táº¡o bÃ i viáº¿t" (Create Post)
         CÃ¡c Namespace: Ä‘á»ƒ sá»­ dá»¥ng cÃ¡c thÃ nh pháº§n trong MAUI, cÃ¡c control tÃ¹y chá»‰nh, vÃ  ViewModel -->

    <Grid RowDefinitions="Auto,*,Auto,Auto,Auto">
        <!-- Khá»Ÿi táº¡o má»™t Grid vá»›i 5 hÃ ng, Ä‘á»‹nh nghÄ©a cáº¥u trÃºc bá»‘ cá»¥c cho cÃ¡c pháº§n trong trang -->

        <!-- ===== HEADER ===== -->
        <Grid ColumnDefinitions="*,*,Auto"
              Grid.Row="0"
              Padding="10">
            <!-- Header cá»§a trang chá»©a thÃ´ng tin Ä‘iá»u hÆ°á»›ng vÃ  avatar ngÆ°á»i dÃ¹ng -->

            <!-- Label trÃ¡i vá»›i chá»©c nÄƒng "back" -->
            <Label Grid.Column="0"
                   BackgroundColor="LightBlue"
                   HorizontalOptions="Center"
                   Text="back"
                   VerticalOptions="Center">
                <Label.GestureRecognizers>
                    <TapGestureRecognizer Tapped="TapGestureRecognizer_Tapped" />
                    <!-- GestureRecognizer Ä‘á»ƒ xá»­ lÃ½ sá»± kiá»‡n tap trÃªn "back" -->
                </Label.GestureRecognizers>
            </Label>

            <!-- Label giá»¯a cÃ³ thá»ƒ lÃ  tiÃªu Ä‘á» hoáº·c cÃ¡c thÃ´ng tin khÃ¡c -->
            <Label Grid.Column="1"
                   BackgroundColor="LightGreen"
                   HorizontalOptions="Center"
                   Text="Cá»™t 2"
                   VerticalOptions="Center" />

            <!-- Grid chá»©a áº£nh avatar vÃ  tÃªn ngÆ°á»i dÃ¹ng -->
            <Grid ColumnDefinitions="Auto, *"
                  Grid.Column="2"
                  VerticalOptions="Start">
                <Image Aspect="AspectFill"
                       Grid.Column="0"
                       HeightRequest="50"
                       Source="account_circle.png"
                       WidthRequest="50">
                    <!-- Avatar cá»§a ngÆ°á»i dÃ¹ng -->
                    <Image.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnAvatarTapped" />
                        <!-- GestureRecognizer cho sá»± kiá»‡n tap trÃªn avatar -->
                    </Image.GestureRecognizers>
                </Image>
                <Label FontAttributes="Bold"
                       FontSize="16"
                       Grid.Column="1"
                       Margin="10,0,0,0"
                       Text="NgÆ°á»i dÃ¹ng"
                       VerticalOptions="Center" />
                <!-- TÃªn ngÆ°á»i dÃ¹ng -->
            </Grid>
        </Grid>

        <!-- ===== SCROLL VIEW Ná»˜I DUNG ===== -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Padding="10"
                                 Spacing="15">
                <!-- VerticalStackLayout chá»©a cÃ¡c thÃ nh pháº§n nháº­p liá»‡u -->

                <!-- Ã” nháº­p ná»™i dung -->
                <Border BackgroundColor="Yellow"
                        Stroke="Gray"
                        StrokeThickness="1">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="10" />
                    </Border.StrokeShape>
                    <Editor FontSize="25"
                            HeightRequest="100"
                            Margin="10"
                            Placeholder="Báº¡n Ä‘ang nghÄ© gÃ¬?"
                            Text="{Binding Content}"
                            VerticalOptions="Start" />
                </Border>
                <!-- ÄÃ¢y lÃ  khu vá»±c nháº­p liá»‡u cho ná»™i dung bÃ i viáº¿t, sá»­ dá»¥ng Editor -->

                <!-- TÃ¹y chá»n Ä‘Ã­nh kÃ¨m -->
                <Grid ColumnDefinitions="*,*,*,*"
                      ColumnSpacing="10"
                      RowDefinitions="Auto,*">
                    <!-- CÃ¡c nÃºt lá»±a chá»n Ä‘á»ƒ Ä‘Ã­nh kÃ¨m vá»‹ trÃ­, tag báº¡n bÃ¨, áº£nh/video, cáº£m xÃºc -->
                    <Button BackgroundColor="Transparent"
                            Clicked="OnAddLocationClicked"
                            Grid.Column="0"
                            Text="ðŸ˜„ Vá»‹ trÃ­"
                            TextColor="Black" />

                    <Button BackgroundColor="Transparent"
                            Clicked="OnTagFriendsClicked"
                            Grid.Column="1"
                            ImageSource="tag_icon.png"
                            Text="ðŸ˜½ Tag báº¡n bÃ¨"
                            TextColor="Black" />

                    <Button BackgroundColor="Pink"
                            
                            Grid.Column="2"
                            ImageSource="image_icon.png"
                            Text="áº¢nh/Video" >
                    <!-- ThÃªm TapGestureRecognizer Ä‘á»ƒ gá»i command SelectPhotoCommand khi nháº¥n -->
                    <Button.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding SelectPhotoCommand}" />
                    </Button.GestureRecognizers>
                        <!-- DataTriggers Ä‘á»ƒ kiá»ƒm tra sá»± thay Ä‘á»•i cá»§a PhotoPath vÃ  áº©n/hiá»‡n nÃºt -->
                        <Button.Triggers>
                            <DataTrigger TargetType="Button"
                                         Binding="{Binding PhotoPath}"
                                         Value="">
                                <Setter Property="IsVisible"
                                        Value="True" />
                               
                                <!-- Hiá»‡n nÃºt khi khÃ´ng cÃ³ áº£nh -->
                          
                                <!-- áº¨n nÃºt khi cÃ³ áº£nh -->
                            </DataTrigger>
                        </Button.Triggers>
                    </Button>
                    <!-- NÃºt thÃªm áº£nh/video vá»›i biá»ƒu tÆ°á»£ng áº£nh -->

                    <Button BackgroundColor="Transparent"
                            Clicked="OnAddEmotionClicked"
                            Grid.Column="3"
                            ImageSource="emotion_icon.png"
                            Text="Cáº£m xÃºc"
                            TextColor="Black" />
                </Grid>

                <!-- ÄÃ¢y lÃ  pháº§n chá»©a cÃ¡c tÃ¹y chá»n Ä‘Ã­nh kÃ¨m (vá»‹ trÃ­, áº£nh, cáº£m xÃºc, tag) -->
                <!-- ===== NÃºt xÃ³a náº±m phÃ­a trÃªn hÃ¬nh áº£nh ===== -->
                <Button Text="XÃ³a"
                        CornerRadius="15"
                        IsVisible="{Binding PhotoPath, Converter={StaticResource NullOrEmptyToBoolConverter}}"
                        Command="{Binding RemovePhotoAsyncCommand}"
                        VerticalOptions="Start"
                        HorizontalOptions="End"
                        Margin="0,10,0,0" />

                <!-- ===== Khung Border chá»©a hÃ¬nh áº£nh ===== -->
                <Border HeightRequest="250"
                        StrokeThickness="0"
                        Grid.Row="1">
                    <!-- DataTrigger Ä‘á»ƒ báº­t/táº¯t Border khi cÃ³ áº£nh -->
                    <Border.Triggers>
                        <DataTrigger TargetType="Border"
                                     Binding="{Binding PhotoPath}"
                                     Value="">
                            <Setter Property="IsVisible"
                                    Value="False" />
                            <!-- áº¨n khi khÃ´ng cÃ³ áº£nh -->
                        </DataTrigger>
                    </Border.Triggers>

                    <!-- HÃ¬nh áº£nh bÃªn trong Border -->
                    <Image HeightRequest="250"
                           Source="{Binding PhotoPath}" />
                </Border>
            </VerticalStackLayout>
        </ScrollView>

        <!-- ===== NÃšT ÄÄ‚NG ===== -->
        <Button BackgroundColor="#1877F2"
               
                CornerRadius="25"
                FontAttributes="Bold"
                FontSize="20"
                Grid.Row="3"
                Text="ÄÄƒng"
                TextColor="White"
                Command="{Binding SavePostCommand}" />
        <!-- NÃºt Ä‘Äƒng bÃ i, khi báº¥m sáº½ gá»i command SavePostCommand trong ViewModel -->
    </Grid>
</ContentPage>
